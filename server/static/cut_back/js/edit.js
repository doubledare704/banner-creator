function EDIT_CLASS(){var a=!1,b=[{},{},{}],c=0;this.edit_undo=function(){this.undo()},this.edit_cut=function(){this.save_state(),0!=DRAW.select_data&&(this.copy_to_clipboard(),canvas_active().clearRect(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT))},this.edit_copy=function(){0!=DRAW.select_data&&this.copy_to_clipboard()},this.edit_paste=function(){this.save_state(),this.paste("menu")},this.edit_select=function(){DRAW.select_data={x:0,y:0,w:WIDTH,h:HEIGHT},canvas_front.clearRect(0,0,WIDTH,HEIGHT),GUI.draw_selected_area()},this.edit_clear=function(){DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT),DRAW.select_square_action=""},this.copy_to_clipboard=function(){a=!1,a=document.createElement("canvas"),a.width=DRAW.select_data.w,a.height=DRAW.select_data.h,a.getContext("2d").drawImage(canvas_active(!0),DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h,0,0,DRAW.select_data.w,DRAW.select_data.h)},this.paste=function(b){if(0==a)return"menu"==b&&(POP.add({title:"Error:",value:"Empty data"}),POP.add({title:"Notice:",value:"To paste from clipboard, use Ctrl-V."}),POP.show("Notice","")),!1;tmp=new Array;var c="Layer #"+(LAYER.layers.length+1);LAYER.create_canvas(c),LAYER.layers.push({name:c,visible:!0}),LAYER.layer_active=LAYER.layers.length-1,canvas_active().drawImage(a,0,0),LAYER.layer_renew()},this.save_state=function(){c=0,j=0,b[2]=b[1],b[1]=b[0],b[j]={},b[j].width=WIDTH,b[j].height=HEIGHT,b[j].data={};for(var a in LAYER.layers)b[j].data[LAYER.layers[a].name]=document.createElement("canvas"),b[j].data[LAYER.layers[a].name].width=WIDTH,b[j].data[LAYER.layers[a].name].height=HEIGHT,b[j].data[LAYER.layers[a].name].getContext("2d").drawImage(document.getElementById(LAYER.layers[a].name),0,0);return!0},this.undo=function(){if(0==b.length)return!1;if(j=c,c++,void 0==b[j]||void 0==b[j].width)return!1;WIDTH==b[j].width&&HEIGHT==b[j].height||(WIDTH=b[j].width,HEIGHT=b[j].height,LAYER.set_canvas_size(!0));for(var a in LAYER.layers)void 0!=b[j].data[LAYER.layers[a].name]&&(document.getElementById(LAYER.layers[a].name).getContext("2d").clearRect(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[a].name).getContext("2d").drawImage(b[j].data[LAYER.layers[a].name],0,0));return GUI.zoom(),!0}}var EDIT=new EDIT_CLASS;