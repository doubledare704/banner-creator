function IMAGE_CLASS(){this.image_information=function(){var a=this.unique_colors_count(canvas_active(!0));a=HELPER.number_format(a,0),POP.add({title:"Width:",value:WIDTH}),POP.add({title:"Height:",value:HEIGHT}),POP.add({title:"Unique colors:",value:a});for(var b in FILE.file_info.general)POP.add({title:b+":",value:FILE.file_info.general[b]});var c=0;for(var b in FILE.file_info.exif)"undefined"!=b&&(0==c&&POP.add({title:"==== EXIF ====",value:""}),POP.add({title:b+":",value:FILE.file_info.exif[b]}),c++);POP.show("Information","")},this.image_size=function(){POP.add({name:"width",title:"Width:",value:WIDTH,placeholder:WIDTH}),POP.add({name:"height",title:"Height:",value:HEIGHT,placeholder:HEIGHT}),POP.show("Attributes",[IMAGE,"resize_custom"])},this.image_trim=function(){EDIT.save_state(),this.trim()},this.image_crop=function(){if(EDIT.save_state(),0==DRAW.select_data)POP.add({html:"Select area first"}),POP.show("Error","");else{for(var a in LAYER.layers){var b=document.getElementById(LAYER.layers[a].name).getContext("2d"),c=b.getImageData(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h);b.clearRect(0,0,WIDTH,HEIGHT),b.putImageData(c,0,0)}EDIT.save_state(),WIDTH=DRAW.select_data.w,HEIGHT=DRAW.select_data.h,LAYER.set_canvas_size(),DRAW.select_data=!1,canvas_front.clearRect(0,0,WIDTH,HEIGHT)}},this.image_resize=function(){this.resize_box()},this.image_rotate_left=function(){EDIT.save_state(),this.rotate_resize_doc(270,WIDTH,HEIGHT),this.rotate_layer({angle:270},canvas_active(),WIDTH,HEIGHT)},this.image_rotate_right=function(){EDIT.save_state(),this.rotate_resize_doc(90,WIDTH,HEIGHT),this.rotate_layer({angle:90},canvas_active(),WIDTH,HEIGHT)},this.image_rotate=function(){POP.add({name:"angle",title:"Enter angle (0-360):",value:0,range:[0,360]}),POP.show("Rotate",function(a){EDIT.save_state(),IMAGE.rotate_resize_doc(a.angle,WIDTH,HEIGHT),IMAGE.rotate_layer(a,canvas_active(),WIDTH,HEIGHT)},function(a,b,c,d){IMAGE.rotate_layer(a,b,c,d)})},this.image_vflip=function(){EDIT.save_state();var a=document.createElement("canvas"),b=a.getContext("2d");a.width=WIDTH,a.height=HEIGHT,b.drawImage(canvas_active(!0),0,0,WIDTH,HEIGHT),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().save(),canvas_active().scale(-1,1),canvas_active().drawImage(a,-WIDTH,0),canvas_active().restore()},this.image_hflip=function(){EDIT.save_state();var a=document.createElement("canvas"),b=a.getContext("2d");a.width=WIDTH,a.height=HEIGHT,b.drawImage(canvas_active(!0),0,0,WIDTH,HEIGHT),canvas_active().clearRect(0,0,WIDTH,HEIGHT),canvas_active().save(),canvas_active().scale(1,-1),canvas_active().drawImage(a,0,-HEIGHT),canvas_active().restore()},this.image_colors=function(){POP.add({name:"param1",title:"Brightness:",value:"0",range:[-100,100]}),POP.add({name:"param2",title:"Contrast:",value:"0",range:[-100,100]}),POP.add({name:"param_red",title:"Red channel:",value:"0",range:[-255,255]}),POP.add({name:"param_green",title:"Green channel:",value:"0",range:[-255,255]}),POP.add({name:"param_blue",title:"Blue channel:",value:"0",range:[-255,255]}),POP.add({name:"param_h",title:"Hue:",value:"0",range:[-180,180]}),POP.add({name:"param_s",title:"Saturation:",value:"0",range:[-100,100]}),POP.add({name:"param_l",title:"Luminance:",value:"0",range:[-100,100]}),POP.show("Brightness Contrast",function(a){EDIT.save_state();var b=parseInt(a.param1),c=parseInt(a.param2),d=parseInt(a.param_red),e=parseInt(a.param_green),f=parseInt(a.param_blue),g=parseInt(a.param_h),h=parseInt(a.param_s),i=parseInt(a.param_l),j=canvas_active().getImageData(0,0,WIDTH,HEIGHT),k=ImageFilters.BrightnessContrastPhotoshop(j,b,c),k=ImageFilters.ColorTransformFilter(k,1,1,1,1,d,e,f,1),k=ImageFilters.HSLAdjustment(k,g,h,i);canvas_active().putImageData(k,0,0),GUI.zoom()},function(a,b,c,d){var e=parseInt(a.param1),f=parseInt(a.param2),g=parseInt(a.param_red),h=parseInt(a.param_green),i=parseInt(a.param_blue),j=parseInt(a.param_h),k=parseInt(a.param_s),l=parseInt(a.param_l),m=b.getImageData(0,0,c,d),n=ImageFilters.BrightnessContrastPhotoshop(m,e,f),n=ImageFilters.ColorTransformFilter(n,1,1,1,1,g,h,i,1),n=ImageFilters.HSLAdjustment(n,j,k,l);b.putImageData(n,0,0)})},this.image_auto_adjust=function(){EDIT.save_state(),this.auto_adjust(canvas_active(),WIDTH,HEIGHT)},this.image_GrayScale=function(){EDIT.save_state();var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT),b=ImageFilters.GrayScale(a);canvas_active().putImageData(b,0,0)},this.image_decrease_colors=function(){POP.add({name:"param1",title:"Colors:",value:"10",range:[2,100]}),POP.add({name:"param2",title:"Dithering:",values:["No","Yes"]}),POP.add({name:"param3",title:"Greyscale:",values:["No","Yes"]}),POP.show("Decrease colors",function(a){EDIT.save_state();var b=parseInt(a.param1);"Yes"==a.param2?param2=!0:param2=!1,"Yes"==a.param3?param3=!0:param3=!1,IMAGE.decrease_colors(canvas_active(!0),canvas_active(!0),WIDTH,HEIGHT,b,param2,param3),GUI.zoom()},function(a,b,c,d){var e=parseInt(a.param1);"Yes"==a.param2?param2=!0:param2=!1,"Yes"==a.param3?param3=!0:param3=!1,IMAGE.decrease_colors(canvas_active(!0),document.getElementById("pop_post"),c,d,e,param2,param3)})},this.image_negative=function(){if(EDIT.save_state(),0==DRAW.select_data)var a=canvas_active().getImageData(0,0,WIDTH,HEIGHT);else var a=canvas_active().getImageData(DRAW.select_data.x,DRAW.select_data.y,DRAW.select_data.w,DRAW.select_data.h);for(var b=a.data,c=0;c<b.length;c+=4)b[c]=255-b[c],b[c+1]=255-b[c+1],b[c+2]=255-b[c+2];0==DRAW.select_data?canvas_active().putImageData(a,0,0):canvas_active().putImageData(a,DRAW.select_data.x,DRAW.select_data.y)},this.image_grid=function(){POP.add({name:"visible",title:"Visible:",value:"Yes",values:["Yes","No"]}),POP.add({name:"gap_x",title:"Horizontal gap:",value:GUI.grid_size[0]}),POP.add({name:"gap_y",title:"Vertical gap:",value:GUI.grid_size[1]}),POP.show("Grid",function(a){"Yes"==a.visible?(GUI.grid=!0,gap_x=a.gap_x,gap_y=a.gap_y,GUI.draw_grid(gap_x,gap_y)):(GUI.grid=!1,GUI.draw_grid())})},this.image_histogram=function(){this.histogram()},this.resize_custom=function(a){EDIT.save_state(),EVENTS.autosize=!1,a.width==WIDTH&&a.height==HEIGHT||(WIDTH=a.width,HEIGHT=a.height,LAYER.set_canvas_size())},this.rotate_resize_doc=function(a,b,c){var d=a*Math.PI/180,e=b*Math.abs(Math.cos(d))+c*Math.abs(Math.sin(d)),f=b*Math.abs(Math.sin(d))+c*Math.abs(Math.cos(d));if(e=Math.ceil(Math.round(1e3*e)/1e3),f=Math.ceil(Math.round(1e3*f)/1e3),WIDTH!=e||HEIGHT!=f){EDIT.save_state();var g=0,h=0;e>WIDTH&&(g=Math.ceil(e-WIDTH)/2,WIDTH=e),f>HEIGHT&&(h=Math.ceil(f-HEIGHT)/2,HEIGHT=f),LAYER.set_canvas_size();for(var i in LAYER.layers){var j=document.getElementById(LAYER.layers[i].name).getContext("2d"),k=j.getImageData(0,0,WIDTH,HEIGHT);j.clearRect(0,0,WIDTH,HEIGHT),j.putImageData(k,g,h)}}},this.rotate_layer=function(a,b,c,d){var e=Math.PI/180;angle=a.angle;var f=document.createElement("canvas"),g=f.getContext("2d");f.width=c,f.height=d;var h=b.getImageData(0,0,c,d);g.putImageData(h,0,0),b.clearRect(0,0,c,d),b.save(),b.translate(Math.round(c/2),Math.round(d/2)),b.rotate(angle*e),b.drawImage(f,-Math.round(c/2),-Math.round(d/2)),b.restore(),c==WIDTH&&GUI.zoom()},this.resize_box=function(){POP.add({name:"width",title:"Width (pixels):",value:"",placeholder:WIDTH}),POP.add({name:"height",title:"Height (pixels):",value:"",placeholder:HEIGHT}),POP.add({name:"width_percent",title:"Width (%):",value:"",placeholder:100}),POP.add({name:"height_percent",title:"Height (%):",value:"",placeholder:100}),POP.add({name:"mode",title:"Mode:",value:"Resample - Hermite",values:["Basic","Resample - Hermite"]}),POP.add({name:"preblur",title:"Pre-Blur:",values:["Yes","No"],value:"No"}),POP.add({name:"sharpen",title:"Sharpen:",values:["Yes","No"],value:"No"}),POP.show("Resize",[IMAGE,"resize_layer"])},this.resize_layer=function(a){EDIT.save_state();var b=parseInt(a.width),c=parseInt(a.height),d=parseInt(a.width_percent),e=parseInt(a.height_percent),f=a.preblur,g=a.sharpen;if(isNaN(b)&&isNaN(c)&&isNaN(d)&&isNaN(e))return!1;if(b==WIDTH&&c==HEIGHT)return!1;if(isNaN(b)&&isNaN(c)&&(0==isNaN(d)&&(b=Math.round(WIDTH*d/100)),0==isNaN(e)&&(c=Math.round(HEIGHT*e/100))),isNaN(b)||isNaN(c)){var h=WIDTH/HEIGHT;isNaN(b)&&(b=Math.round(c*h)),isNaN(c)&&(c=Math.round(b/h))}if((b>WIDTH||c>HEIGHT)&&(a.mode="Resize"),"Yes"==f){var i=WIDTH/b,j=HEIGHT/c,k=Math.max(i,j),l=.3*k;if(l>.6){var m=canvas_active().getImageData(0,0,WIDTH,HEIGHT),n=ImageFilters.GaussianBlur(m,l);canvas_active().putImageData(n,0,0)}}(b>WIDTH||c>HEIGHT)&&(a.mode="Resize");var p;Date.now();if("Resample - Hermite"==a.mode&&(p="Hermite",this.resample_hermite(canvas_active(!0),WIDTH,HEIGHT,b,c),"layer_resize"!=GUI.last_menu&&(WIDTH=b,HEIGHT=c,WIDTH<1&&(WIDTH=1),HEIGHT<1&&(HEIGHT=1),LAYER.set_canvas_size()),GUI.zoom()),"Resize"==a.mode&&(p="Default",tmp_data=document.createElement("canvas"),tmp_data.width=WIDTH,tmp_data.height=HEIGHT,tmp_data.getContext("2d").drawImage(canvas_active(!0),0,0),canvas_active().clearRect(0,0,WIDTH,HEIGHT),WIDTH=b,HEIGHT=c,LAYER.set_canvas_size(),canvas_active().drawImage(tmp_data,0,0,b,c),"layer_resize"!=GUI.last_menu&&this.trim(),GUI.zoom()),"Yes"==g){var m=canvas_active().getImageData(0,0,WIDTH,HEIGHT),n=ImageFilters.Sharpen(m,1);canvas_active().putImageData(n,0,0)}},this.trim_info=function(a,b,c){var d=0,e=0,f=0,g=0,h=a.getContext("2d").getImageData(0,0,a.width,a.height),i=h.data;a:for(var j=0;j<h.height;j++){for(var k=0;k<h.width;k++){var l=j*(4*h.width)+4*k;if(0!=i[l+3]&&(c===!0||255!=i[l]||255!=i[l+1]||255!=i[l+2]))break a}d++}a:for(var k=0;k<h.width;k++){for(var j=0;j<h.height;j++){var l=j*(4*h.width)+4*k;if(0!=i[l+3]&&(c===!0||255!=i[l]||255!=i[l+1]||255!=i[l+2]))break a}e++}a:for(var j=h.height-1;j>=0;j--){for(var k=h.width-1;k>=0;k--){var l=j*(4*h.width)+4*k;if(0!=i[l+3]&&(c===!0||255!=i[l]||255!=i[l+1]||255!=i[l+2]))break a}f++}a:for(var k=h.width-1;k>=0;k--){for(var j=h.height-1;j>=0;j--){var l=j*(4*h.width)+4*k;if(0!=i[l+3]&&(c===!0||255!=i[l]||255!=i[l+1]||255!=i[l+2]))break a}g++}return{top:d,left:e,bottom:f,right:g}},this.trim=function(a,b,c){var d=HEIGHT,e=WIDTH,f=HEIGHT,g=WIDTH;for(var h in LAYER.layers)if(void 0==a||LAYER.layers[h].name==a){var i=0,j=0,k=0,l=0,m=document.getElementById(LAYER.layers[h].name).getContext("2d").getImageData(0,0,WIDTH,HEIGHT),n=m.data;a:for(var o=0;o<m.height;o++){for(var p=0;p<m.width;p++){var q=o*(4*m.width)+4*p;if(0!=n[q+3]&&(c===!0||255!=n[q]||255!=n[q+1]||255!=n[q+2]))break a}i++}a:for(var p=0;p<m.width;p++){for(var o=0;o<m.height;o++){var q=o*(4*m.width)+4*p;if(0!=n[q+3]&&(c===!0||255!=n[q]||255!=n[q+1]||255!=n[q+2]))break a}j++}a:for(var o=m.height-1;o>=0;o--){for(var p=m.width-1;p>=0;p--){var q=o*(4*m.width)+4*p;if(0!=n[q+3]&&(c===!0||255!=n[q]||255!=n[q+1]||255!=n[q+2]))break a}k++}a:for(var p=m.width-1;p>=0;p--){for(var o=m.height-1;o>=0;o--){var q=o*(4*m.width)+4*p;if(0!=n[q+3]&&(c===!0||255!=n[q]||255!=n[q+1]||255!=n[q+2]))break a}l++}d=Math.min(d,i),e=Math.min(e,j),f=Math.min(f,k),g=Math.min(g,l)}for(var h in LAYER.layers)if(void 0==a||LAYER.layers[h].name==a){tmp_data=document.getElementById(LAYER.layers[h].name).getContext("2d").getImageData(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[h].name).getContext("2d").clearRect(0,0,WIDTH,HEIGHT),document.getElementById(LAYER.layers[h].name).getContext("2d").putImageData(tmp_data,-e,-d);LAYER.layers[h].name}if(void 0!=b)return!1;if(void 0!=a){var s=Math.round(WIDTH-e-g),t=Math.round(HEIGHT-d-f),u=document.getElementById(a).getContext("2d").getImageData(0,0,s,t);return document.getElementById(a).width=s,document.getElementById(a).height=t,document.getElementById(a).getContext("2d").clearRect(0,0,s,t),document.getElementById(a).getContext("2d").putImageData(u,0,0),{top:d,left:e,bottom:f,right:g}}WIDTH=WIDTH-e-g,HEIGHT=HEIGHT-d-f,WIDTH<1&&(WIDTH=1),HEIGHT<1&&(HEIGHT=1),LAYER.set_canvas_size(),LAYER.update_info_block()},this.decrease_colors=function(a,b,c,d,e,f,g){var h=b.getContext("2d"),i=h.getImageData(0,0,c,d),j=i.data,k=[],l=10,m=canvas_front;m.clearRect(0,0,c,d),m.drawImage(a,0,0,Math.ceil(a.width/l),Math.ceil(a.height/l));var n=m.getImageData(0,0,Math.ceil(a.width/l),Math.ceil(a.height/l)),o=n.data;m.clearRect(0,0,c,d);for(var p=0;p<o.length;p+=4)if(0!=o[p+3]){var q=Math.round(.2126*o[p]+.7152*o[p+1]+.0722*o[p+2]);k.push([o[p],o[p+1],o[p+2],q])}for(var r=[],p=0;p<256;p++)r[p]=0;for(var p=0;p<k.length;p++)r[k[p][3]]++;for(var s=30;s<300&&!(k.length<=e);s+=30)for(var p=0;p<k.length&&!(k.length<=e);p++){for(var t=!0,u=0;u<k.length&&!(k.length<=e);u++)if(p!=u&&Math.abs(k[p][0]-k[u][0])+Math.abs(k[p][1]-k[u][1])+Math.abs(k[p][2]-k[u][2])<s){if(!(r[k[p][3]]>r[k[u][3]])){t=!1;break}k.splice(u,1),u--}0==t&&(k.splice(p,1),p--)}for(var v=k.length,u=0;u<d;u++)for(var p=0;p<c;p++){var w=u*(4*c)+4*p;if(0!=j[w+3]){for(var z,q=Math.round(.2126*o[w]+.7152*o[w+1]+.0722*o[w+2]),x=0,y=999999,A=0;A<v;A++){var B=Math.abs(k[A][0]-j[w])+Math.abs(k[A][1]-j[w+1])+Math.abs(k[A][2]-j[w+2]);B<y&&(y=B,x=A,z=B)}if(0==f)j[w]=k[x][0],j[w+1]=k[x][1],j[w+2]=k[x][2];else{if(z>=10)for(var C,E,D=768,A=0;A<v;A++)if(A!=x&&!(k[x][3]<q&&k[A][3]<q||k[x][3]>q&&k[A][3]>q)){var B=Math.abs(k[A][0]-j[w])+Math.abs(k[A][1]-j[w+1])+Math.abs(k[A][2]-j[w+2]);B<D&&(D=B,C=A,E=B)}var F;if(void 0==C)F=k[x];else{var G=HELPER.getRandomInt(-z,E);F=G<0?k[C]:k[x]}j[w]=F[0],j[w+1]=F[1],j[w+2]=F[2]}if(1==g){var H=Math.round(.2126*j[w]+.7152*j[w+1]+.0722*j[w+2]);j[w]=H,j[w+1]=H,j[w+2]=H}}}b.getContext("2d").putImageData(i,0,0)},this.auto_adjust=function(a,b,c){var d=240,e=30,f=1,g=.5,h=1.1,i=10;document.body.style.cursor="wait";for(var j=a.getImageData(0,0,b,c),k=j.data,l=0,m=0,n=0;n<k.length;n+=4)0!=k[n+3]&&((k[n]+k[n+1]+k[n+2])/3>d&&m++,l++);target=f;for(var o=0,p=!1,q=0;q<i&&(100*m/l>=target&&(p=!0),1!=p);q++){o++;for(var n=0;n<k.length;n+=4)if(0!=k[n+3])for(var r=0;r<3;r++){var s=n+r;k[s]<10||(k[s]*=h,k[s]=Math.round(k[s]),k[s]>255&&(k[s]=255))}m=0;for(var n=0;n<k.length;n+=4)0!=k[n+3]&&(k[n]+k[n+1]+k[n+2])/3>d&&m++}m=0;for(var n=0;n<k.length;n+=4)0!=k[n+3]&&(k[n]+k[n+1]+k[n+2])/3<e&&m++;target=g;for(var t=0,p=!1,q=0;q<i&&(100*m/l>=target&&(p=!0),1!=p);q++){t++;for(var n=0;n<k.length;n+=4)if(0!=k[n+3])for(var r=0;r<3;r++){var s=n+r;k[s]>240||(k[s]-=(255-k[s])*h-(255-k[s]),k[s]=Math.round(k[s]))}m=0;for(var n=0;n<k.length;n+=4)0!=k[n+3]&&(k[n]+k[n+1]+k[n+2])/3<e&&m++}a.putImageData(j,0,0),document.body.style.cursor="auto"},this.resample_hermite=function(a,b,c,d,e){for(var f=a.getContext("2d").getImageData(0,0,b,c),g=a.getContext("2d").getImageData(0,0,d,e),h=f.data,i=g.data,j=b/d,k=c/e,l=Math.ceil(j/2),m=Math.ceil(k/2),n=0;n<e;n++)for(var o=0;o<d;o++){for(var p=4*(o+n*d),q=0,r=0,s=0,t=gx_g=gx_b=gx_a=0,u=(n+.5)*k,v=Math.floor(n*k);v<(n+1)*k;v++)for(var w=Math.abs(u-(v+.5))/m,x=(o+.5)*j,y=w*w,z=Math.floor(o*j);z<(o+1)*j;z++){var A=Math.abs(x-(z+.5))/l,B=Math.sqrt(y+A*A);B>=-1&&B<=1&&(q=2*B*B*B-3*B*B+1,q>0&&(A=4*(z+v*b),gx_a+=q*h[A+3],s+=q,h[A+3]<255&&(q=q*h[A+3]/250),t+=q*h[A],gx_g+=q*h[A+1],gx_b+=q*h[A+2],r+=q))}i[p]=t/r,i[p+1]=gx_g/r,i[p+2]=gx_b/r,i[p+3]=gx_a/s}a.getContext("2d").clearRect(0,0,Math.max(b,d),Math.max(c,e)),a.getContext("2d").putImageData(g,0,0)},this.histogram=function(){POP.add({name:"param1",title:"Channel:",values:["Gray","Red","Green","Blue"],onchange:"IMAGE.histogram_onload()"}),POP.add({title:"Histogram:",function:function(){var a='<canvas style="position:relative;" id="c_h" width="256" height="100"></canvas>';return a}}),POP.add({title:"Total pixels:",value:""}),POP.add({title:"Average:",value:""}),POP.show("Histogram",void 0,void 0,this.histogram_onload)},this.histogram_onload=function(a){var b=canvas_active().getImageData(0,0,WIDTH,HEIGHT),c=b.data,d=document.getElementById("pop_data_param1_poptmp0"),e=document.getElementById("pop_data_param1_poptmp1"),f=document.getElementById("pop_data_param1_poptmp2"),g=document.getElementById("pop_data_param1_poptmp3");1==d.checked?channel=d.value:1==e.checked?channel=e.value:1==f.checked?channel=f.value:1==g.checked&&(channel=g.value);for(var h=[],i=0;i<=255;i++)h[i]=0;var l,j=c.length/4,k=0;if("Gray"==channel)for(var i=0;i<c.length;i+=4)l=Math.round((c[i]+c[i+1]+c[i+2])/3),h[l]++,k=k+c[i]+c[i+1]+c[i+2];else if("Red"==channel)for(var i=0;i<c.length;i+=4)h[c[i]]++,k+=3*c[i];else if("Green"==channel)for(var i=0;i<c.length;i+=4)h[c[i+1]]++,k+=3*c[i+1];else if("Blue"==channel)for(var i=0;i<c.length;i+=4)h[c[i+2]]++,k+=3*c[i+2];var m=document.getElementById("c_h").getContext("2d");m.rect(0,0,255,100),m.fillStyle="#ffffff",m.fill();for(var i=0;i<=255;i++)0!=h[i]&&(m.beginPath(),m.strokeStyle="#000000",m.lineWidth=1,m.moveTo(i+.5,100.5),m.lineTo(i+.5,100-Math.round(255*h[i]*100/j/6)+.5),m.stroke());document.getElementById("pop_data_totalpixel").innerHTML=HELPER.number_format(j,0),j>0?average=Math.round(10*k/j/3)/10:average="-",document.getElementById("pop_data_average").innerHTML=average},this.unique_colors_count=function(a){for(var b=a.getContext("2d").getImageData(0,0,a.width,a.height),c=b.data,d=[],e=0,f=0;f<c.length;f+=4)if(0!=c[f+3]){var g=c[f]+"."+c[f+1]+"."+c[f+2];void 0==d[g]&&(d[g]=1,e++)}return e}}var IMAGE=new IMAGE_CLASS;